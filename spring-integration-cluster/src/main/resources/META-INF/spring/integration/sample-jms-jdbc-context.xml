<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:int-jms="http://www.springframework.org/schema/integration/jms"
	xmlns:task="http://www.springframework.org/schema/task"
	xsi:schemaLocation="http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.1.xsd
		http://www.springframework.org/schema/integration/jms http://www.springframework.org/schema/integration/jms/spring-integration-jms-2.1.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<!-- inbound adapter -->
	<int-jms:message-driven-channel-adapter id="sample.inbound.adapter"
		channel="integration.cluster.inbound" 
		connection-factory="connectionFactory"
		transaction-manager="jmsTransactionManager"
		auto-startup="false" 
		destination="cluster.in.queue" />

	<!-- Send cluster heartbeats to the inbound queue -->
	<int-jms:outbound-channel-adapter channel="integration.cluster.heartbeat"
		destination="cluster.in.queue"
		jms-template="jmsTemplate" />

	<int-jms:channel id="strict.ordering.to.worker" 
		connection-factory="connectionFactory"
		transaction-manager="jmsTransactionManager"
		queue-name="strict.order.workQ"
		concurrency="5"
		task-executor="worker.exec"/>
		
	<task:executor id="worker.exec" pool-size="5"/>

	<bean id="strict.order.work.queue" class="org.apache.activemq.command.ActiveMQQueue">
		<constructor-arg value="strict.order.workQ"/>
	</bean>

</beans>
